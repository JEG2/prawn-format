<html>
<head>
<style type='text/css'>body {
  margin-left: 15%;
  margin-right: 15%;
  margin-top: 1em;
}

pre.highlight {
  background-color: #f8f8f8;
  border: 1px solid silver;
  font-family: Courier, monospace;
  font-size: 90%;
  color: #100;
  line-height: 1.1em;
  padding: 1em;
}

.highlight .af { color:#00C }
.highlight .an { color:#007 }
.highlight .av { color:#700 }
.highlight .aw { color:#C00 }
.highlight .bi { color:#509; font-weight:bold }
.highlight .c  { color:#888 }

.highlight .ch { color:#04D }
.highlight .ch .k { color:#04D }
.highlight .ch .dl { color:#039 }

.highlight .cl { color:#B06; font-weight:bold }
.highlight .co { color:#036; font-weight:bold }
.highlight .cr { color:#0A0 }
.highlight .cv { color:#369 }
.highlight .df { color:#099; font-weight:bold }
.highlight .di { color:#088; font-weight:bold }
.highlight .dl { color:black }
.highlight .do { color:#970 }
.highlight .ds { color:#D42; font-weight:bold }
.highlight .e  { color:#666; font-weight:bold }
.highlight .en { color:#800; font-weight:bold }
.highlight .er { color:#F00; background-color:#FAA }
.highlight .ex { color:#F00; font-weight:bold }
.highlight .fl { color:#60E; font-weight:bold }
.highlight .fu { color:#06B; font-weight:bold }
.highlight .gv { color:#d70; font-weight:bold }
.highlight .hx { color:#058; font-weight:bold }
.highlight .i  { color:#00D; font-weight:bold }
.highlight .ic { color:#B44; font-weight:bold }

.highlight .il { background: #eee }
.highlight .il .il { background: #ddd }
.highlight .il .il .il { background: #ccc }
.highlight .il .dl { font-weight: bold ! important; color: #888 ! important }

.highlight .in { color:#B2B; font-weight:bold }
.highlight .iv { color:#33B }
.highlight .la { color:#970; font-weight:bold }
.highlight .lv { color:#963 }
.highlight .oc { color:#40E; font-weight:bold }
.highlight .on { color:#000; font-weight:bold }
.highlight .op { }
.highlight .pc { color:#038; font-weight:bold }
.highlight .pd { color:#369; font-weight:bold }
.highlight .pp { color:#579 }
.highlight .pt { color:#339; font-weight:bold }
.highlight .r  { color:#080; font-weight:bold }

.highlight .rx { background-color:#fff0ff }
.highlight .rx .k { color:#808 }
.highlight .rx .dl { color:#404 }
.highlight .rx .mod { color:#C2C }
.highlight .rx .fu  { color:#404; font-weight: bold }

.highlight .s  { background-color:#fff0f0 }
.highlight .s  .s { background-color:#ffe0e0 }
.highlight .s  .s  .s { background-color:#ffd0d0 }
.highlight .s  .k { color:#D20 }
.highlight .s  .dl { color:#710 }

.highlight .sh { background-color:#f0fff0 }
.highlight .sh .k { color:#2B2 }
.highlight .sh .dl { color:#161 }

.highlight .sy { color:#A60 }
.highlight .sy .k { color:#A60 }
.highlight .sy .dl { color:#630 }

.highlight .ta { color:#070 }
.highlight .tf { color:#070; font-weight:bold }
.highlight .ts { color:#D70; font-weight:bold }
.highlight .ty { color:#339; font-weight:bold }
.highlight .v  { color:#036 }
.highlight .xt { color:#444 }

</style>
</head><body>
<h1>Prawn::Format 0.1.0</h1>
<p class='indent'><em>A PDF version of this document may be downloaded <a href="http://jamisbuck.org/files/prawn-format-0.1.0.pdf">here</a>.</em></p>
<p class=''>Prawn::Format is an extension library for the Prawn PDF generation library for Ruby, allowing you to easily embed formatting <em>tags</em> in your documents. It features:</p>
<ul>
<li>Out-of-the-box support for many common HTML tags</li>
<li>Intra-document hyperlinks</li>
<li>Easily add your own tag definitions</li>
<li>Style classes</li>
</ul>
<p class='indent'>Sound good? It's not all roses, though. Prawn::Format currently has the following known warts:</p>
<ul>
<li>No support for block-level tags (paragraphs, divs, tables, etc.)</li>
<li>No support for inline images</li>
</ul>
<p class='indent'>If that doesn't deter you, read on! This manual currently has information about the following topics:</p>
<ul>
<li><a href="#basic-usage">Basic usage</a></li>
<li><a href="#custom-tags">Custom tags</a></li>
<li><a href="#style-classes">Style classes</a></li>
<li><a href="#text-options"><code>text()</code> options</a></li>
</ul>
<p class='indent'>Prawn::Format was written by Jamis Buck (jamis@jamisbuck.org). Although there are not currently plans to extend the functionality much beyond the current incarnation, Jamis is definitely amenable to patches. What this means is that if you've got a pet feature you'd like to see in Prawn::Format, your best bet is to get to work and implement it!</p>
<p class='indent'>Bug reports are welcome, and may be submitted at:</p>
<center><b>http://prawn.lighthouseapp.com/projects/23476</b></center>
<p class='indent'>And if you're inclined to help out with patches and the like, the code is hosted at (where else?) GitHub:</p>
<center><b>http://github.com/jamis/prawn-format</b></center>
<p class='indent'>Thanks!</p>
<hr />
<p class=''><about>This manual generated for Prawn::Format version 0.1.0 on 26 January 2009 at 21:11 UTC.</about></p>
<hr />
<h2><a name="basic-usage"></a>Basic usage</h2>
<p class=''>For most uses, adding text to your documents is exactly the same as it is in Prawn. The only difference is that you now add formatting tags (HTML-ish in nature) to the strings:</p>
<pre class='highlight'>require <span class="s"><span class="dl">'</span><span class="k">prawn</span><span class="dl">'</span></span>
require <span class="s"><span class="dl">'</span><span class="k">prawn/format</span><span class="dl">'</span></span>

<span class="co">Prawn</span>::<span class="co">Document</span>.generate(<span class="s"><span class="dl">'</span><span class="k">basics.pdf</span><span class="dl">'</span></span>) <span class="r">do</span>
  text <span class="s"><span class="dl">&quot;</span><span class="k">Some &lt;b&gt;bold&lt;/b&gt; and &lt;i&gt;italic&lt;/i&gt; text</span><span class="dl">&quot;</span></span>
<span class="r">end</span>
</pre><p class='indent'>Prawn::Format does not support even the majority of HTML tags by default, but it does include support for the most common ones (and you can easily <a href="#custom-tags">add others</a> if you so desire). The supported tags are:</p>
<ul>
<li><code>a</code> &mdash; for hyperlinks (the <code>name</code> attribute is for hyperlink anchors, and the <code>href</code> attribute is for the actual links, just like in HTML)</li>
<li><code>b</code> &mdash; bold-faced text (but only if the currently selected font family supports bold text)</li>
<li><code>br</code> &mdash; line break</li>
<li><code>code</code> &mdash; switch to monospaced font (Courier, by default)</li>
<li><code>em</code> &mdash; italicized text (but only if the currently selected font family supports italicized text)</li>
<li><code>font</code> &mdash; change font attributes, include <code>face</code> (to change font family), <code>color</code>, and <code>size</code></li>
<li><code>i</code> &mdash; italicized text (see <code>em</code>)</li>
<li><code>pre</code> &mdash; "verbatim" text (preserving whitespace and newlines). Unlike the HTML <code>pre</code> tag, this is not a block tag</li>
<li><code>span</code> &mdash; has no formatting, by default, but is recognized so that you can apply <a href="#style-classes">style classes</a> to the tag</li>
<li><code>strong</code> &mdash; bold-faced text (see <code>b</code>)</li>
<li><code>sub</code> &mdash; subscript text</li>
<li><code>sup</code> &mdash; superscript text</li>
<li><code>tt</code> &mdash; monospaced font (see <code>code</code>)</li>
<li><code>u</code> &mdash; underlined text</li>
</ul>
<p class='indent'>You've likely noticed, already, the conspicuous absence of such common HTML tags as <code>p</code>, <code>div</code>, and <code>table</code>. The reason these are missing is simple: Prawn::Format has no real box model. Turns out, implementing such a beast is a really, really complicated thing to do right. However, you can work around this limitation without too much effort. In fact, <em>the <a href="http://jamisbuck.org/files/prawn-format-0.1.0.pdf">PDF version of this manual</a> was entirely formatted using Prawn::Format!</em> (The source code for the manual is included in the Prawn::Format distribution; see <code>manual/pdf.rb</code> and <code>manual/html.rb</code>. Also, <code>examples/document.rb</code> has a simpler demonstration of wholesale document formatting.)</p>
<p class='indent'>One particularly important thing to note about Prawn::Format tags: these are XML tags, and not HTML tags! The distinction is moot in most cases, but what this means in practical terms is that you <em>cannot</em> have unclosed tags in Prawn::Format. Even tags like <code>&lt;br&gt;</code> (which HTML allows to exist unclosed) must be closed. However, Prawn::Format allows you to use the abbreviated "open/close" XML syntax, e.g., <code>&lt;br/&gt;</code>.</p>
<p class='indent'>Lastly, Prawn::Format will ignore whitespace, just like HTML. (Unless you're operating in verbatim mode, usually introduced via the <code>&lt;pre&gt;</code> tag.) This means that newlines in your text will <em>not</em> translate to newlines in your output; you need to use the line-break tag <code>&lt;br/&gt;</code> to put line-breaks in your output.</p>
<pre class='highlight'><span class="c"># renders all on one line</span>
text <span class="s"><span class="dl">&lt;&lt;-TEXT</span></span><span class="s"><span class="k">
  &amp;bull; Item one
  &amp;bull; Item two
  &amp;bull; Item three</span><span class="dl">
TEXT</span></span>

<span class="c"># renders all on three separate lines</span>
text <span class="s"><span class="dl">&lt;&lt;-TEXT</span></span><span class="s"><span class="k">
  &amp;bull; Item one&lt;br/&gt;
  &amp;bull; Item two&lt;br/&gt;
  &amp;bull; Item three</span><span class="dl">
TEXT</span></span>
</pre><p class='indent'>Got all that? Great! Time to move on to more tricky stuff. Next up: <a href="#custom-tags">custom tags</a>!</p>
<hr />
<h2><a name="custom-tags"></a>Custom tags</h2>
<p class=''>Prawn::Format makes it very easy to define your own tags, either for clearer semantic markup or to add support for HTML tags that are not supported out-of-the-box.</p>
<pre class='highlight'><span class="co">Prawn</span>::<span class="co">Document</span>.generate(<span class="s"><span class="dl">'</span><span class="k">basics.pdf</span><span class="dl">'</span></span>) <span class="r">do</span>
  tags <span class="sy">:h1</span> =&gt; { <span class="sy">:font_size</span> =&gt; <span class="s"><span class="dl">&quot;</span><span class="k">3em</span><span class="dl">&quot;</span></span>, <span class="sy">:font_weight</span> =&gt; <span class="sy">:bold</span> },
    <span class="sy">:h2</span> =&gt; { <span class="sy">:font_size</span> =&gt; <span class="s"><span class="dl">&quot;</span><span class="k">2em</span><span class="dl">&quot;</span></span>, <span class="sy">:font_style</span> =&gt; <span class="sy">:italic</span> },
    <span class="sy">:product</span> =&gt; { <span class="sy">:color</span> =&gt; <span class="s"><span class="dl">&quot;</span><span class="k">red</span><span class="dl">&quot;</span></span>,
                  <span class="sy">:text_decoration</span> =&gt; <span class="sy">:underline</span> }

  text <span class="s"><span class="dl">&quot;</span><span class="k">&lt;h1&gt;Manual&lt;/h1&gt;</span><span class="dl">&quot;</span></span>
  text <span class="s"><span class="dl">&quot;</span><span class="k">&lt;h2&gt;Learning to do stuff&lt;/h2&gt;</span><span class="dl">&quot;</span></span>
  text <span class="s"><span class="dl">&quot;</span><span class="k">&lt;product&gt;Prawn&lt;/product&gt; is a PDF generator for Ruby</span><span class="dl">&quot;</span></span>
<span class="r">end</span>
</pre><p class='indent'>If you want to tweak the definition of an existing tag, you can reach right into the tags hash directly and add or modify existing styles:</p>
<pre class='highlight'>tags[<span class="sy">:em</span>][<span class="sy">:color</span>] = <span class="s"><span class="dl">&quot;</span><span class="k">red</span><span class="dl">&quot;</span></span>
text <span class="s"><span class="dl">&quot;</span><span class="k">This really &lt;em&gt;matters&lt;/em&gt;!</span><span class="dl">&quot;</span></span>
</pre><p class='indent'>The supported style options are:</p>
<ul>
<li><code>font_size</code></li>
<li><code>font_family</code> (this may be any font name that Prawn's <code>Document#font</code> method will support)</li>
<li><code>font_style</code> &mdash; either <code>:normal</code> or <code>:italic</code></li>
<li><code>font_weight</code> &mdash; either <code>:normal</code> or <code>:bold</code></li>
<li><code>color</code> &mdash; may be any valid HTML color definition</li>
<li><code>vertical_align</code> &mdash; either <code>:super</code> or <code>:sub</code>, or a number to indicate the vertical offset from the baseline</li>
<li><code>text_decoration</code> &mdash; either <code>:none</code> or <code>:underline</code></li>
<li><code>white_space</code> &mdash; either <code>:normal</code>, or <code>:pre</code> (for verbatim text, where whitespace is preserved)</li>
<li><code>width</code> &mdash; a number, used primarily to fake text indents at paragraph starts. Any tag with this attribute will have a width of that value (in addition to any contents of the tag)</li>
<li><code>kerning</code> &mdash; either true or false, to indicate whether kerning should be done on the text</li>
</ul>
<p class='indent'>As you can see, for the most part these follow the same naming and value schemes as CSS3, though of course the similarity is only superficial. Prawn::Format doesn't support cascading styles, or specifying <a href="#style-classes">style classes</a> by anything other than a bare class name. (Maybe someday this will change. If it does, it'll be thanks to some enterprising programmer who submits a patch.)</p>
<p class='indent'>Still, even with the limitations, you can do quite a bit. For example, suppose you want indent the first line of a paragraph in your own document. Prawn::Format doesn't support this out of the box, but it's easy to do; just define an <code>&lt;indent&gt;</code> tag and give it a width the size of the text indent; then prepend that tag to every paragraph:</p>
<pre class='highlight'>tags[<span class="sy">:indent</span>] = { <span class="sy">:width</span> =&gt; <span class="s"><span class="dl">&quot;</span><span class="k">2em</span><span class="dl">&quot;</span></span> }

text <span class="s"><span class="dl">&quot;</span><span class="k">&lt;indent/&gt;Once upon a time, far, far away...</span><span class="dl">&quot;</span></span>
text <span class="s"><span class="dl">&quot;</span><span class="k">&lt;indent/&gt;But the prince was not discouraged! ...</span><span class="dl">&quot;</span></span>
</pre><p class='indent'>Oh, and did you catch that? Just like in CSS, you can specify most measurements in ems (e.g. <code>"2em"</code>), picas (<code>"3pc"</code>), inches (<code>"0.5in"</code>), or PDF "points" (<code>14</code>). There are 72 PDF points to an inch, and 6 picas to an inch. Also, like CSS, you can specify relative measurements, using percentages, in which case it is relative to some appropriate value. (Setting width to <code>"25%"</code> will set it to 25% of the width of the line. Setting the font size to <code>"80%"</code> will set it to 80% of the current font size.)</p>
<hr />
<h2><a name="style-classes"></a>Style classes</h2>
<p class=''>Adding a new tag for every different style in your document can get to be pretty cumbersome. For that reason, you can also define <em>style classes</em>. This is simply a style definition (just like you would use for <a href="#custom-tags">defining a new tag</a>). To apply the style to a tag, do just like you would in HTML: specify the style class in the <code>class</code> attribute of the tag:</p>
<pre class='highlight'>styles <span class="sy">:product</span> =&gt; { <span class="sy">:color</span> =&gt; <span class="s"><span class="dl">&quot;</span><span class="k">navy</span><span class="dl">&quot;</span></span> },
       <span class="sy">:ruby</span> =&gt; { <span class="sy">:color</span> =&gt; <span class="s"><span class="dl">&quot;</span><span class="k">red</span><span class="dl">&quot;</span></span>, <span class="sy">:font_family</span> =&gt; <span class="s"><span class="dl">&quot;</span><span class="k">Courier</span><span class="dl">&quot;</span></span>,
                  <span class="sy">:white_space</span> =&gt; <span class="sy">:pre</span> }
text <span class="s"><span class="dl">&quot;</span><span class="k">In &lt;b class='product'&gt;Ruby&lt;/b&gt;, you can write </span><span class="dl">&quot;</span></span> +
     <span class="s"><span class="dl">&quot;</span><span class="k">&lt;code class='ruby'&gt;1.upto(5) { |x| puts x }&lt;/code&gt;</span><span class="dl">&quot;</span></span>
</pre><p class='indent'>As mentioned before, Prawn::Format doesn't support cascading styles (i.e. you can't specify the format of an element by the chain of elements and styles in it's ancestor elements). And sadly, in practice, this does limit the ease with which you can apply complex styles. However, with judicious use of both style classes and <a href="#custom-tags">custom tags</a> you can do quite a bit.</p>
<hr />
<h2><a name="text-options"></a><code>text()</code> options</h2>
<p class=''>Prawn::Format overloads the existing functionality of Prawn's <code>Document#text</code> method. In fact, unless formatting tags or XML entities are detected in the text, Prawn::Format's <code>text</code> method will simply fall back to the original. (Why? Because if you don't need the formatting, it's <em>much</em> faster to skip all the extra work that Prawn::Format does.)</p>
<p class='indent'>What this means is that Prawn::Format tries very hard to support all of the options that Prawn's <code>text</code> method accepts.</p>
<p class='indent'>Prawn::Format does <em>add</em> several new options to <code>text</code>, though. They are as follows:</p>
<ul>
<li><code>:plain</code> &mdash; a boolean indicating whether the text is "plain" or not. Plain text is processed by the original <code>text</code> method. By default, Prawn::Format analyzes the text to determine plainness, but this option lets you force it one way or the other.</li>
<li><code>:align => :justify</code> &mdash; the original <code>text</code> method understood several text alignment methods, but not full-justification. Prawn::Format will understand all the original methods, and also <code>:justify</code>, for full justification.</li>
<li><code>:tags</code> &mdash; a hash of tag definitions to use for this one call. Prawn::Format will always use the tags defined via <code>Document#tags</code>, but anything you specify via the <code>:tags</code> option takes precedent.</li>
<li><code>:styles</code> &mdash; a hash of style class definitions to use for this one call. Prawn::Format will always use the style classes defined via <code>Document#styles</code>, but anything you specify via the <code>:styles</code> option takes precedent.</li>
<li><code>:default_style</code> &mdash; a hash of style definitions that defines the default style to use for any otherwise-unstyled text. This defaults to the current font and color settings on the document, but you can set something else via this option.</li>
</ul>
<p class='indent'>Here are a few examples using these options:</p>
<pre class='highlight'><span class="c"># force unformatted display</span>
text <span class="s"><span class="dl">&quot;</span><span class="k">Show &lt;b&gt;this&lt;/b&gt; verbatim</span><span class="dl">&quot;</span></span>, <span class="sy">:plain</span> =&gt; <span class="pc">true</span>

<span class="c"># force formatted display for full justification</span>
text <span class="s"><span class="dl">&quot;</span><span class="k">I want this to be fully justified</span><span class="dl">&quot;</span></span>, <span class="sy">:plain</span> =&gt; <span class="pc">false</span>,
  <span class="sy">:align</span> =&gt; <span class="sy">:justify</span>

<span class="c"># assume all text is blue</span>
text <span class="s"><span class="dl">&quot;</span><span class="k">Blue text</span><span class="dl">&quot;</span></span>, <span class="sy">:plain</span> =&gt; <span class="pc">false</span>,
  <span class="sy">:default_style</span> =&gt; { <span class="sy">:color</span> =&gt; <span class="s"><span class="dl">&quot;</span><span class="k">blue</span><span class="dl">&quot;</span></span> }

<span class="c"># one-off tag and style definitions</span>
text <span class="s"><span class="dl">&quot;</span><span class="k">&lt;nifty class='orange'&gt;Nifty!&lt;/nifty&gt;</span><span class="dl">&quot;</span></span>,
  <span class="sy">:tags</span> =&gt; { <span class="sy">:nifty</span> =&gt; { <span class="sy">:font_weight</span> =&gt; <span class="sy">:bold</span> } },
  <span class="sy">:styles</span> =&gt; { <span class="sy">:orange</span> =&gt; { <span class="sy">:color</span> =&gt; <span class="s"><span class="dl">&quot;</span><span class="k">#fa0</span><span class="dl">&quot;</span></span> } }
</pre></body>
</html>
